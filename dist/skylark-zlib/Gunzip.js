/**
 * skylark-zlib - A version of zlib.js that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-zlib/
 * @license MIT
 */
define(["./zlib","./crc32","./Gzip","./RawInflate","./GunzipMember"],function(e,t,r,i,n){var o=function(e,t){this.input=e,this.ip=0,this.member=[],this.decompressed=!1};return o.prototype.getMembers=function(){return this.decompressed||this.decompress(),this.member.slice()},o.prototype.decompress=function(){for(var e=this.input.length;this.ip<e;)this.decodeMember();return this.decompressed=!0,this.concatMember()},o.prototype.decodeMember=function(){var e,o,s,c,a,h,d,l,m,f=new n,p=this.input,g=this.ip;if(f.id1=p[g++],f.id2=p[g++],31!==f.id1||139!==f.id2)throw new Error("invalid file signature:"+f.id1+","+f.id2);switch(f.cm=p[g++],f.cm){case 8:break;default:throw new Error("unknown compression method: "+f.cm)}if(f.flg=p[g++],l=p[g++]|p[g++]<<8|p[g++]<<16|p[g++]<<24,f.mtime=new Date(1e3*l),f.xfl=p[g++],f.os=p[g++],(f.flg&r.FlagsMask.FEXTRA)>0&&(f.xlen=p[g++]|p[g++]<<8,g=this.decodeSubField(g,f.xlen)),(f.flg&r.FlagsMask.FNAME)>0){for(d=[],h=0;(a=p[g++])>0;)d[h++]=String.fromCharCode(a);f.name=d.join("")}if((f.flg&r.FlagsMask.FCOMMENT)>0){for(d=[],h=0;(a=p[g++])>0;)d[h++]=String.fromCharCode(a);f.comment=d.join("")}if((f.flg&r.FlagsMask.FHCRC)>0&&(f.crc16=65535&t.calc(p,0,g),f.crc16!==(p[g++]|p[g++]<<8)))throw new Error("invalid header crc16");if(e=p[p.length-4]|p[p.length-3]<<8|p[p.length-2]<<16|p[p.length-1]<<24,p.length-g-4-4<512*e&&(c=e),o=new i(p,{index:g,bufferSize:c}),f.data=s=o.decompress(),g=o.ip,f.crc32=m=(p[g++]|p[g++]<<8|p[g++]<<16|p[g++]<<24)>>>0,t.calc(s)!==m)throw new Error("invalid CRC-32 checksum: 0x"+t.calc(s).toString(16)+" / 0x"+m.toString(16));if(f.isize=e=(p[g++]|p[g++]<<8|p[g++]<<16|p[g++]<<24)>>>0,(4294967295&s.length)!==e)throw new Error("invalid input size: "+(4294967295&s.length)+" / "+e);this.member.push(f),this.ip=g},o.prototype.decodeSubField=function(e,t){return e+t},o.prototype.concatMember=function(){var e,t,r,i=this.member,n=0,o=0;for(e=0,t=i.length;e<t;++e)o+=i[e].data.length;for(r=new Uint8Array(o),e=0;e<t;++e)r.set(i[e].data,n),n+=i[e].data.length;return r},e.Gunzip=o});
//# sourceMappingURL=sourcemaps/Gunzip.js.map
